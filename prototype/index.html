<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Single Keystroke Inputs Form</title>
		<style>
			body {
				color: white;
				background-color: black;
				display: flex;
				height: 100vh;
			}
			#app {
				margin: auto;
			}
			.form-row {
				display: flex;
				align-items: center;
				margin-bottom: 10px;
				text-align: center;
			}
			.form-row input {
				width: 40px;
				height: 80px;
				margin: 10px;
			}
			input[type='number'] {
				font:
					50px 'Din Alternate',
					monospace;
				border: 1px solid silver;
				border-radius: 5px;
				text-align: center;
			}
			input[type='number'].no-arrows::-webkit-inner-spin-button,
			input[type='number']::-webkit-outer-spin-button {
				-webkit-appearance: none;
				margin: 0;
			}
			#output {
				color: white;
				font:
					50px 'Din Alternate',
					monospace;
			}
		</style>
	</head>
	<body>
		<div id="app">
			<form action="#" method="POST">
				<div class="form-row">
					<input
						type="number"
						name="hours10"
						id="hours10"
						min="0"
						max="6"
						class="no-arrows"
						onkeypress="return isNumberKey(event)"
					/>
					<input
						type="number"
						name="hours1"
						id="hours1"
						min="0"
						max="9"
						class="no-arrows"
						onkeypress="return isNumberKey(event)"
					/>
					&nbsp;:&nbsp;
					<input
						type="number"
						name="minutes10"
						id="minutes10"
						min="0"
						max="6"
						class="no-arrows"
						onkeypress="return isNumberKey(event)"
					/>
					<input
						type="number"
						name="minutes1"
						id="minutes1"
						min="0"
						max="9"
						class="no-arrows"
						onkeypress="return isNumberKey(event)"
					/>
					&nbsp;:&nbsp;
					<input
						type="number"
						name="seconds10"
						id="seconds10"
						min="0"
						max="6"
						class="no-arrows"
						onkeypress="return isNumberKey(event)"
					/>
					<input
						type="number"
						name="seconds1"
						id="seconds1"
						min="0"
						max="9"
						class="no-arrows"
						onkeypress="return isNumberKey(event)"
					/>
				</div>
				<button type="button" onclick="makeTimer()">Make String</button>
			</form>
			<div id="output">
				<span id="hours">00</span>:<span id="minutes">00</span>:<span id="seconds">00</span>
			</div>
		</div>
		<script>
			function isNumberKey(evt) {
				var charCode = evt.which ? evt.which : evt.keyCode;
				if (charCode > 31 && (charCode < 48 || charCode > 57)) return false;
				return true;
			}

			var inputs = document.querySelectorAll('input[type="number"]');

			inputs.forEach(function (input, index) {
				input.addEventListener('input', function () {
					// If input value length is equal to maxlength
					console.log('Typed in ' + index);

					if (input.value.length === 1) {
						// Focus on the next input if it exists
						if (index < inputs.length - 1) {
							inputs[index + 1].focus();
						} else {
							// else remove all focus
							console.log('Removing all focus.');
							document.activeElement = null; // TODO: this doesn't work; maybe move focus to the submit button?
						}
					}
				});
			});

			function makeTimer() {
				let hours10 = document.getElementById('hours10').value;
				let hours1 = document.getElementById('hours1').value;
				let minutes10 = document.getElementById('minutes10').value;
				let minutes1 = document.getElementById('minutes1').value;
				let seconds10 = document.getElementById('seconds10').value;
				let seconds1 = document.getElementById('seconds1').value;
				let timer = [hours10, hours1, minutes10, minutes1, seconds10, seconds1];

				if (hours10 === '') {
					hours10 = 0;
				}

				// let hours = hours10 + hours1;
				// let minutes = minutes10 + minutes1;
				// let seconds = seconds10 + seconds1;

				document.getElementById('hours').innerText = toString(timer[0]) + toString(timer[1]);
				document.getElementById('minutes').innerText = toString(timer[2]) + toString(timer[3]);
				document.getElementById('seconds').innerText = toString(timer[4]) + toString(timer[5]);
				var resultString = toString(timer[0]) + toString(timer[1]);
				+':' +
					toString(timer[2]) +
					toString(timer[3]) +
					':' +
					toString(timer[4]) +
					toString(timer[5]);
				console.log(resultString); // or do something else with the result string
				countdown(timer);
			}

			function countdown(timerArray) {
				var interval = setInterval(function () {
					// Decrement the last element of the array (seconds)
					timerArray[5]--;

					// If seconds reach 0, decrement the next element (tens of seconds)
					if (timerArray[5] < 0) {
						timerArray[5] = 9;
						timerArray[4]--;
					}

					// If tens of seconds reach -1, decrement the next element (minutes)
					if (timerArray[4] < 0) {
						timerArray[4] = 5;
						timerArray[3]--;
					}

					// If minutes reach -1, decrement the next element (tens of minutes)
					if (timerArray[3] < 0) {
						timerArray[3] = 9;
						timerArray[2]--;
					}

					// If tens of minutes reach -1, decrement the next element (hours)
					if (timerArray[2] < 0) {
						timerArray[2] = 5;
						timerArray[1]--;
					}

					// If hours reach -1, decrement the next element (tens of hours)
					if (timerArray[1] < 0) {
						timerArray[1] = 9;
						timerArray[0]--;
					}

					// If all elements become 0, stop the countdown
					if (timerArray.every((value) => value === 0)) {
						clearInterval(interval);
					}

					console.log(timerArray); // Output the current time array
				}, 100); // Interval of tenths of a second (100 milliseconds)
			}

			// Example usage
			// var initialTime = [0, 5, 3, 0, 1, 0];
			// countdown(initialTime);
		</script>
	</body>
</html>
